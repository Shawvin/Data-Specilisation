x3<-mtcars$wt
y3<-mtcars$mpg
fit<-lm(y3~x3)
summary(fit)
fit
fit[1]
fit[2]
fit[1]
summary(fit)
fit$coefficients[1]
fit$coefficients[2]
fit$coefficients[1]+fit$coefficients[2]*3000
ex<-fit$coefficients[1]+fit$coefficients[2]*3000
ex
ex<-fit$coefficients[0]+fit$coefficients[1]*3000
wx
ex
ex<-fit$coefficients[0]+fit$coefficients[1]*3
ex
ex<-fit$coefficients[1]+fit$coefficients[2]*3
ex
ex+3.046*qt(0.95,30)
fit$coefficients[1]+fit$coefficients[2]*2
rm(ls())
rm(ls=ls())
rm(list=ls())
fit<-lm(mpg~wt,data=mtcars)
fit1<-lm(mpg~1,data=mtcars)
fit
summary(fit)
summary(fit1)
sigma<-summary(fit)$sigma
sigma1<-summary(fit1)$sigma
sigma^2*30/(sigma1^2*31)
mean(mtcars$mpg)
?relevel
?reorder
str(mtcars)
str(airquality)
str(iris)
level(iris$Species)
levels(iris$Species)
labels(iris$Species)
as.numeric(iris$Species)
?factor
factor(letters[1:20], labels = "letter")
l<-factor(letters[1:20], labels = "letter")
l[1]
levels(l0)
levels(l)
letters[1:20]
as.character(l)
l1<-factor(letters[1:20])
l1
levels(l1)<-"letters"
labels(l1)<-"letters"
label(l1)<-"letters"
l1
labels(l1)
labels(l1)<-letters[20:1]
levels(l1)<-letters[20:1]
l1
labels(l1)
l2<-factor(1:20)
l2
l3<-factor(seq(1,10,0.5))
l3
levels(l3)
labels(l3)
as.numeric(l3)
levels(l3)[levels]
levels(l3)[levels(13)]
levels(l3)[levels(l3)]
levels(l3)[l3]
levels(l3)
as.numeric(level(l3))
as.numeric(levels(l3))
as.numeric(levels(l3)[l3])
l4<-sample(l3)
l4
as.numeric(levels(l4))
as.numeric(levels(l4)[l4])
library(rg)
install.packages("rg")
install.packages("rgl")
plot3d(mtcars$wt,mtcars$mpg)
head(mtcars)
plot3d(mtcars$wt,mtcars$mpg,mtcars$disp)
library(rgl)
plot3d(mtcars$wt,mtcars$mpg,mtcars$disp)
data<-data.frame(x=1:10,y=1:10,z=1:10)
data
apply(data,1,mean)
apply(data,2,mean)
coef(lm(y~x,data=data))
coef(lm(y~x,data=data))[2]
fit<-lm(mpg~wt,data=mtcars)
predict(fit,newdata=3)
predict(fit,newdata=data.frame(wt=3))
predict(fit,newdata=data.frame(wt=3),interval="predict")
predict(fit,newdata=data.frame(wt=3),interval="interval")
predict(fit,newdata=data.frame(wt=3),interval="confidence")
predict(fit,newdata=data.frame(wt=mean(mtcars$wt)),interval="confidence")
predict(fit,newdata=data.frame(wt=mean(mtcars$wt)),interval="predict")
n=2:100
a_n<-1/n*(-1)^n
sum(a_n)+1
sum(a_n)+2
e
a_n<-1/n*
1
a_n<-1/n
sum(a_n)+1
?rpois
rpois(10,0.1)
rpois(10,0.1)
rpois(10,0.1)
rpois(10,0.5)
?rexp
a<-1:100
b<-1:20
a-b
a
b
(a-b)
(2*a-b)
rm(list=ls())
swirl()
install_from_swirl("Linear Regression")
swirl()
ones<-rep(1,nrow(galton))
lm(child~ones+parent-1,galton)
lm(child~parent,galton)
lm(child~1,galton)
view(trees)
haed(trees)
head(trees)
fit<-lm(volume~Girth+Height+COnstant-``)
fit<-lm(volume~Girth+Height+Constant-1,trees)
fit<-lm(Volume~Girth+Height+Constant-1,trees)
trees2<-eliminate("Girth",trees)
head(trees2)
fit2<-lm(Volume~Height+Constant-1,trees2)
lapply(list(fit,fit2),coef)
?teeth
head(teeth)
library(UsingR)
head(teeth)
?ToothGrowth
swirl()
lm(Fertility~.,data=swiss)
all<-lm(Fertility~.,data=swiss)
all
summary(aa)
summary(ll)
summary(all)
lm(Fertility~agriculture,data=swiss)
lm(Fertility~Agriculture,data=swiss)
summary(lm(Fertility~Agriculture,data=swiss))
cor(Examination~Education,data=swiss)
cor(Examination~Education)
cor(Examination,Education)
cor(swiss$Examination,swiss$Education)
cor(swiss$Agriculture,swiss$Education)
makelm()
makelms()
ec<-sum(swiss$Examination,swiss$Catholic)
ec<-(swiss$Examination+swiss$Catholic)
ec<-swiss$Examination+swiss$Catholic
efit<-lm(Fertility~.+ec,data=swiss)
all-efit
all$coefficients-efit$coefficients
head(swiss)
dim(swiss)
fit<-lm(Fertility~.,data=swiss)
summary(fit)
fit2<-lm(Fertility~.-Examination,data=swiss)
summary(fit2)
plot(predict(fit),resid(fit))
hline(h=0)
?vline
?hline
?abline(h=0)
abline(h=0)
abline(v=0)
abline(v=60)
plot(fit,[2])
plot(fit,2)
plot(predict(fit2),resid(fit2))
plot(fit2,2)
par(mfrow=c(2,2))
plot(fit)
plot(fit2)
par(mfrow=c(1,1))
plot(fit2,4)
plot(fit2,3)
plot(fit2,2)
plot(fit2,4)
plot(fit2,5)
plot(fit2,6)
plot(fit2,7)
plot(fit2,5)
plot(fit2,3)
plot(fit2,4)
plot(fit2,5)
influence.measures(fit2)
fit3<-lm(Fertility~Agriculture,swiss)
summary(fit3)
dim(mtcars)
head(mtcars)
mc<-lm(mpg~.,mtcars)
summary(mc)
mc<-mtcars
mc$cyl<-factor(mc$cyl)
str(mc)
?mtcars
mc$vs<-factor(mc$vs)
mc$am<-factor(mc$am)
mc$gear<-factor(mc$gear)
mc$carb<-factor(mc$carb)
mcfit<-lm(mpg~.,mc)
summary(mcfit)
mcfit<-lm(mpg~.-1,mc)
summary(mcfit)
str(mc)
mcfit<-lm(mpg~am,mc)
summary(mcfit)
mcfit<-lm(mpg~.-carb,mc)
summary(mcfit)
mcfit<-lm(mpg~.-carb-gear,mc)
summary(mcfit)
mcfit<-lm(mpg~.-carb-gear-cyl,mc)
summary(mcfit)
mcfit<-lm(mpg~.-carb-gear-cyl-vs,mc)
summary(mcfit)
mcfit<-lm(mpg~.-carb-gear-cyl-vs-drat,mc)
summary(mcfit)
mcfit<-lm(mpg~.-carb-gear-cyl-vs-drat-disp,mc)
summary(mcfit)
mcfit<-lm(mpg~.-carb-gear-cyl-vs-drat-disp-hp,mc)
summary(mcfit)
mcfit<-lm(mpg~wt+qsec+am,mc)
summary(mcfit)
mcfit<-lm(mpg~wt+qsec+am-1,mc)
summary(mcfit)
plot(mcfit,1)
plot(mcfit,2)
plot(mcfit,3)
plot(mcfit,4)
plot(mcfit,5)
plot(mcfit,6)
plot(mcfit,5)
plot(mcfit,4)
plot(mcfit,3)
plot(mcfit,2)
plot(mcfit,1)
library(swirl)
swirl()
swirl
library("swirl")
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
data(mtcars)
dim(mtcars)
str(mtcars)
mtcars$vs<-factor(mtcars$vs)
levels(mtcars$vs)<-c("-Vshaped","-straight")
mtcars$am<-factor(mtcars$am)
levels(mtcars$am)<-c("-auto","-manual")
str(mtcars)
fit1<-lm(mpg~am,mtcars)
summary(fit1)
plot(predict(fit1),resid(fit1))
plot(fit1,2)
shapiro.test(predict(fit1))
fitall<-lm(mpg~.,mtcars)
summary(fitall)
plot(fitall,2)
plot(predict(fitall),resid(fitall))
shapiro.test(predict(fitall))
fitall<-lm(mpg~.,mtcars)
summary(fitall)
plot(fitall,2)
plot(predict(fitall),resid(fitall))
shapiro.test(predict(fitall))
anova(fit1,fitall)
fit1
summary(fit1)$R.sqaured
summary(fit1)
summary(fit1)[2]
summary(fit1)[1]
summary(fit1)[3]
summary(fit1)[4]
summary(fit1)[5]
summary(fit1)[6]
summary(fit1)$sigma
summary(fit1)[7]
summary(fit1)[8]
summary(fit1)$r.squared
fit1<-lm(mpg~am,mtcars)
summary(fit1)
plot(predict(fit1),resid(fit1))
plot(fit1,2)
shapiro.test(predict(fit1))
step(fitall)
mtcars$cyl$factor(mtcars$cyl)
mtcars$cyl<-factor(mtcars$cyl)
mtcars$vs<-factor(mtcars$vs)
levels(mtcars$vs)<-c("-Vshaped","-straight")
mtcars$am<-factor(mtcars$am)
levels(mtcars$am)<-c("-auto","-manual")
mtcars$gear<-factor(mtcars$gear)
mtcars$carb<-factor(mtcars$carb)
str(mtcars)
fit1<-lm(mpg~am,mtcars)
summary(fit1)
plot(predict(fit1),resid(fit1))
plot(fit1,2)
shapiro.test(predict(fit1))
fitall<-lm(mpg~.,mtcars)
summary(fitall)
plot(fitall,2)
plot(predict(fitall),resid(fitall))
shapiro.test(predict(fitall))
anova(fit1,fitall)
step(fitall)
fit-best<-lm(mpg~cyl+hp+wt+am,mtcars)
fit_best<-lm(mpg~cyl+hp+wt+am,mtcars)
summary(fit_best)
anova(fit1,fit_best,fitall)
plot(fit_best,2)
shapiro.test(fit_best)
shapiro.test(predict(fit_best)
)
plot(fit_best,1)
summary(fit_best)$r.squared
library(car)
install.packages("car")
install.packages("car")
library(car)
install.packages("car")
install.packages("car")
library(car)
vif(fti1)
vif(fit1)
vif(fitall)
vif(fit_best)
knitr::opts_chunk$set(echo = TRUE)
mtcars$cyl<-factor(mtcars$cyl)
mtcars$vs<-factor(mtcars$vs)
levels(mtcars$vs)<-c("-Vshaped","-straight")
mtcars$am<-factor(mtcars$am)
levels(mtcars$am)<-c("-auto","-manual")
mtcars$gear<-factor(mtcars$gear)
mtcars$carb<-factor(mtcars$carb)
str(mtcars)
fitall<-lm(mpg~.,mtcars)
summary(fitall)
plot(fitall,2)
plot(predict(fitall),resid(fitall))
shapiro.test(predict(fitall))
vif(fitall)
fit1<-lm(mpg~am,mtcars)
summary(fit1)
fitall<-lm(mpg~.,mtcars)
summary(fitall)
plot(fitall,2)
plot(predict(fitall),resid(fitall))
shapiro.test(predict(fitall))
vif(fitall)
fitall<-lm(mpg~.,mtcars)
summary(fitall)
plot(fitall,2)
plot(predict(fitall),resid(fitall))
shapiro.test(predict(fitall))
vif(fitall)
step(fitall)
fit_best<-lm(mpg~cyl+hp+wt+am,mtcars)
summary(fit_best)
plot(fit_best,1)
plot(predict(fit_best),resdi(fit_best))
fit_best<-lm(mpg~cyl+hp+wt+am,mtcars)
summary(fit_best)
plot(fit_best,1)
plot(predict(fit_best),resid(fit_best))
anova(fit1,fit_best,fitall)
suppressMessages(library(car))
data(mtcars)
dim(mtcars)
str(mtcars)
knitr::opts_chunk$set(echo = TRUE)
step(fitall)
mtcars$cyl<-factor(mtcars$cyl)
mtcars$vs<-factor(mtcars$vs)
levels(mtcars$vs)<-c("-Vshaped","-straight")
mtcars$am<-factor(mtcars$am)
levels(mtcars$am)<-c("-auto","-manual")
mtcars$gear<-factor(mtcars$gear)
mtcars$carb<-factor(mtcars$carb)
str(mtcars)
knitr::opts_chunk$set(echo = TRUE)
suppressMessages(library(car))
data(mtcars)
dim(mtcars)
str(mtcars)
mtcars$cyl<-factor(mtcars$cyl)
mtcars$vs<-factor(mtcars$vs)
levels(mtcars$vs)<-c("-Vshaped","-straight")
mtcars$am<-factor(mtcars$am)
levels(mtcars$am)<-c("-auto","-manual")
mtcars$gear<-factor(mtcars$gear)
mtcars$carb<-factor(mtcars$carb)
summary(fit1)
fit1<-lm(mpg~am,mtcars)
summary(fit1)
fitall<-lm(mpg~.,mtcars)
summary(fitall)
plot(fitall,2)
plot(predict(fitall),resid(fitall))
shapiro.test(predict(fitall))
vif(fitall)
summary(fit_best)
str(mtcars)
summary(fit1)
suppressMessages(library(car))
data(mtcars)
dim(mtcars)
str(mtcars)
mtcars$cyl<-factor(mtcars$cyl)
mtcars$vs<-factor(mtcars$vs)
levels(mtcars$vs)<-c("-Vshaped","-straight")
mtcars$am<-factor(mtcars$am)
levels(mtcars$am)<-c("-auto","-manual")
mtcars$gear<-factor(mtcars$gear)
mtcars$carb<-factor(mtcars$carb)
fit1<-lm(mpg~am,mtcars)
fitall<-lm(mpg~.,mtcars)
fit_best<-lm(mpg~cyl+hp+wt+am,mtcars)
anova(fit1,fit_best,fitall)
summary(fitall)
vif(fitall)
summary(fit_best)
plot(fit_best,1)
plot(predict(fit_best),resid(fit_best))
shapiro.test(resid(fit_best))
summary(fit_best)
plot(fit_best,1)
plot(predict(fit_best),resid(fit_best))
plot(fit_best,2)
shapiro.test(resid(fit_best))
step(fitall)
getwd()\
getwd()
setwd("./Desktop/Coursera")
setwd("./Desktops/Coursera")
getwd()
setwd("./")
dir(0)
dir()
getwd()
setwd("./Desktop")
setwd("../Desktop")
setwd("Coursear")
setwd("Coursera")
getwd(0)
getwd()
ls(0)
ls()
dir()
dir.create("C8Week2")
setwd("C8Week2")
testing <- adData[-inTrain,]
testing<-adData[-inTrain,]
library(caret)
library(AppliedPredictiveModeling)
set.seed(3433)
data(AlzheimerDisease)
library(AppliedPredictiveModeling)
source('~/.active-rstudio-document')
dim(training)
grep("^IL",names(training),value=TRUE)
smallTrain<-training[selected,]
selected<-grep("^IL",names(training),value=TRUE)
smallTrain<-training[selected,]
prComp<-prcomp(smallTrain)
smallTrain<-training[,selected]
prComp<-prcomp(smallTrain)
summary(prComp)
prComp$rotation
source('C:/Users/Wang Xiaoyuan/Desktop/Coursera/C8Week2/PCA in R.R')
source('C:/Users/Wang Xiaoyuan/Desktop/Coursera/C8Week2/PCA in R.R')
smallTrain<-training[,selected]
source('C:/Users/Wang Xiaoyuan/Desktop/Coursera/C8Week2/PCA in R.R')
summary(prComp1)
summary(prComp2)
source('C:/Users/Wang Xiaoyuan/Desktop/Coursera/C8Week2/PCA in R.R')
source('C:/Users/Wang Xiaoyuan/Desktop/Coursera/C8Week2/PCA in R.R')
par(mfrow=c(1,2))
source('C:/Users/Wang Xiaoyuan/Desktop/Coursera/C8Week2/PCA in R.R')
summary(prComp1)
prComp2
summary(prComp2)
summary(prComp1)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
modelFit1
modelFit2
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
confusionMatrix(smallTest$diagnosis,predict(modelFit1,smallTest))
confusionMatrix(smallTest$diagnosis,predict(modelFit2,smallTest))
