library(dplyr)
library(ggplot2)
data<-read.csv(unz("repdata_data_activity.zip","activity.csv"))
data$date<-as.Date(as.character(data$date),"%Y-%m-%d")
dim(data)
head(data)
?POSIXct
?POSIXlt
as.posixct("0015","%H%M")
as.posixct("0015",format="%H%M")
?strptime
strptime("0015",format="%H%M")
strptime("0015","%H%M")
library(dplyr)
library(ggplot2)
data<-read.csv(unz("repdata_data_activity.zip","activity.csv"))
data$date<-as.Date(as.character(data$date),"%Y-%m-%d")
daily<-with(data,tapply(steps,interval,mean,na.rm=TRUE))
plot(strptime(sprint("%04d",names(daily)),"%H%M"),daily,type="l",xlab="Interval",ylab="Numbers of teps")
daily<-with(data,tapply(steps,interval,mean,na.rm=TRUE))
plot(strptime(sprintf("%04d",names(daily)),"%H%M"),daily,type="l",xlab="Interval",ylab="Numbers of teps")
library(dplyr)
library(ggplot2)
data<-read.csv(unz("repdata_data_activity.zip","activity.csv"))
data$date<-as.Date(as.character(data$date),"%Y-%m-%d")
data$interval<-sprintf("04d",data$interval)
head(data)
library(dplyr)
library(ggplot2)
data<-read.csv(unz("repdata_data_activity.zip","activity.csv"))
data$date<-as.Date(as.character(data$date),"%Y-%m-%d")
data$interval<-sprintf("%04d",data$interval)
head(data)
total_steps<-with(data,tapply(steps,date,sum,na.rm=TRUE))
hist(total_steps)
mean_steps<-round(mean(total_steps))
median_steps<-median(total_steps)
daily<-with(data,tapply(steps,interval,mean,na.rm=TRUE))
plot(strptime(names(daily),"%H%M"),daily,type="l",xlab="Interval",ylab="Numbers of teps")
#plot(names(daily),daily,type="l",xlab="Interval",ylab="Numbers of teps")
index<-names(which.max(daily))
max_step<-round(max(daily))
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
dim(plotdata)
head(plotdata)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
str(data)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-strptime(plotdata$interval,"%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
str(plodata)
str(plotdata)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-format(plotdata$interval,"%H%M")
dim(plotdata)
unique(plotdata$interval)
str(plotdata)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-strptime(plotdata$interval,"%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-as.posixct(plotdata$interval,"%H%M")
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-as.posixlt(plotdata$interval,"%H%M")
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-as.POSIXct(plotdata$interval,"%H%M")
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-as.POSIXct(plotdata$interval,"%H%M")
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval1<-as.POSIXct(plotdata$interval,"%H%M")
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-as.POSIXct(plotdata$interval,"%H%M")
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
#plotdata$interval<-
as.POSIXct(plotdata$interval[1],"%H%M")
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
#plotdata$interval<-
as.POSIXct(plotdata$interval[2],"%H%M")
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
#plotdata$interval<-
as.POSIXlt(plotdata$interval[2],"%H%M")
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
#plotdata$interval<-
strptime(plotdata$interval,"%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-strptime(plotdata$interval,"%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
str(plotdata)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-format(as.POSIXct(plotdata$interval,format="%H%M"))
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
str(plotdata)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-strptime(plotdata$interval,format="%H%M"))
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-strptime(plotdata$interval,format="%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-as.POSIXct(plotdata$interval,format="%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
str(data)
str(plotdata)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
#plotdata$interval<-as.POSIXct(plotdata$interval,format="%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
str(plotdata)
dim(plotdata)
head(plotdata)
str(data)
daily<-with(data,tapply(steps,interval,mean,na.rm=TRUE))
plot(strptime(names(daily),"%H%M"),daily,type="l",xlab="Interval",ylab="Numbers of teps")
index<-names(which.max(daily))
max_step<-round(max(daily))
No_of_missing<-sum(is.na(data$steps))
#the missing data will be imputed with the mean of that 5-min #interval
missing<-is.na(data$steps)
data[missing,]$steps<-daily[as.character(data[missing,]$interval)]
No_of_missing<-sum(is.na(data$steps))
#the missing data will be imputed with the mean of that 5-min #interval
missing<-is.na(data$steps)
data[missing,]$steps<-daily[data[missing,]$interval]
No_of_missing<-sum(is.na(data$steps))
#the missing data will be imputed with the mean of that 5-min #interval
missing<-is.na(data$steps)
data[missing,]$steps<-daily[data[missing,]$interval]
length(daily)
daily
names(daily)
class(names(daily))
str(data)
dim(data[missing,])
library(dplyr)
library(ggplot2)
data<-read.csv(unz("repdata_data_activity.zip","activity.csv"))
data$date<-as.Date(as.character(data$date),"%Y-%m-%d")
data$interval<-sprintf("%04d",data$interval)
str(data)
dim(data)
ls()
rm(list=ls())
library(dplyr)
library(ggplot2)
data<-read.csv(unz("repdata_data_activity.zip","activity.csv"))
data$date<-as.Date(as.character(data$date),"%Y-%m-%d")
data$interval<-sprintf("%04d",data$interval)
dim(data)
str(data)
sum(is.na(data$steps))
total_steps<-with(data,tapply(steps,date,sum,na.rm=TRUE))
hist(total_steps)
mean_steps<-round(mean(total_steps))
median_steps<-median(total_steps)
No_of_missing<-sum(is.na(data$steps))
#the missing data will be imputed with the mean of that 5-min #interval
missing<-is.na(data$steps)
data[missing,]$steps<-daily[data[missing,]$interval]
daily<-with(data,tapply(steps,interval,mean,na.rm=TRUE))
plot(strptime(names(daily),"%H%M"),daily,type="l",xlab="Interval",ylab="Numbers of teps")
index<-names(which.max(daily))
max_step<-round(max(daily))
length(daily)
sum(is.na(data$steps))
No_of_missing<-sum(is.na(data$steps))
#the missing data will be imputed with the mean of that 5-min #interval
missing<-is.na(data$steps)
data[missing,]$steps<-daily[data[missing,]$interval]
str(data)
total_steps_2<-with(data,tapply(steps,date,sum))
hist(total_steps_2)
mean_steps<-round(mean(total_steps_2))
median_steps<-median(total_steps_2)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
#plotdata$interval<-as.POSIXct(plotdata$interval,format="%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
str(plotdata)
dim(plotdata)
sum(is.na(plotdat$steps))
sum(is.na(plotdata$steps))
No_of_missing<-sum(is.na(data$steps))
#the missing data will be imputed with the mean of that 5-min #interval
missing<-is.na(data$steps)
data[missing,]$steps<-daily[data[missing,]$interval]
sum(is.na(data$steps))
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
#plotdata$interval<-as.POSIXct(plotdata$interval,format="%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
str(plotdata)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
#plotdata$interval<-as.POSIXct(plotdata$interval,format="%H%M")
ggplot(plotdata,aes(interval,steps))+geom_line()+facet_grid(day~.)
plotdata
group<-data %>% group_by(day,interval)
dim(group)
str(group)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
#plotdata$interval<-as.POSIXct(plotdata$interval,format="%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-as.POSIXct(plotdata$interval,format="%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
#create new factor variable with two levels: "Weekday","Weekend"
days<-unique(weekdays(data$date))
data<-transform(data,day=factor(weekdays(data$date) %in% days[1:5]))
levels(data$day)<-c("Weekday","Weekend")
plotdata<-data %>% group_by(day,interval) %>% summarize(steps=mean(steps))
plotdata$interval<-as.POSIXct(plotdata$interval,format="%H%M")
ggplot(plotdata,aes(interval,steps,color=day))+geom_line()+facet_grid(day~.)
