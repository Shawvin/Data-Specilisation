---
title: "Statistical inference course project"
author: "Shawvin"
date: "7/3/2019"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part 1: Simulation exercise

### Overview
This Simulation exercise investigate the exponential distribution and compare it with Central Limit Theorem.The exponential distribution can be simulated in R as rexp(n,lambda). The mean and standard devitaion for the exponential distribution will be 1/lambda.

### Simulations
We will set lambda=0.2 for the simulation.The sample will be averages of 40 exponentials for 1000 simulation.

```{r}
set.seed(1234)
lambda<-0.2
mns<-NULL

#1000 simulations are run, and each simulation will calculate the mean of 40 random exponential and generate 1 sample mean, so 1000 sample means will be collected.
for(i in 1:1000)
  mns<-c(mns,mean(rexp(40,lambda)))

#Sample Mean will be the mean of these 1000 sample means 
#Sample Variance will be the variance of these 1000 sample means
Sample_Mean<-mean(mns)
Sample_Var<-var(mns)

#Theoretical Mean and Theoretical Variance are 1/lambda and 1/(lambda^2*n) respectivly
Theoretical_Mean<-1/lambda
Theoretical_Var<-1/(lambda^2*40)

```

### Sample Mean versus Theoretical Mean
```{r echo=FALSE}
hist(mns,xlab="sample means",breaks=20,main="Histogram of sample means")
abline(v=Sample_Mean,col="red",lwd=2)
Sample_Mean_label<-paste("Sample Mean",round(Sample_Mean,2),sep="")
text(Sample_Mean,0,Sample_Mean_label,adj=c(1,0),col="red")
abline(v=Theoretical_Mean,col="blue",lwd=2)
Theoretical_Mean_label<-paste("Theoretical Mean=",round(Theoretical_Mean,2),sep="")
text(Theoretical_Mean,0,Theoretical_Mean_label,adj=c(0,0),col="blue")
```
The histogram of 1000 sample means is plotted and the mean of these 1000 sample means is used as Sample Mean. In the plot, redline denotes the Sample Mean and the blue line denotes the Theoretical Mean. Their value are `r Sample_Mean` and `r Theoretical_Mean`

### Sample Variance versus Theoretical Variance
```{r,echo=FALSE}
hist(mns-Sample_Mean,xlab="adjusted sample means",breaks=20,main="Histogram of sample means")
abline(v=Sample_Var,col="red",lwd=2)
Sample_Var_label<-paste("Sample Variance=",round(Sample_Var,2),sep="")
text(Sample_Var,0,Sample_Var_label,adj=c(1,0),col="red")
abline(v=Theoretical_Var,col="blue",lwd=2)
Theoretical_Var_label<-paste("Theoretical Variance=",round(Theoretical_Var,2),sep="")
text(Theoretical_Var,0,Theoretical_Var_label,adj=c(0,0),col="blue")
```
The histogram of 1000 sample means is plotted.Sample Variance is the variance of these 1000 sample means.For comparing the variance more esaily, the Sample Mean of these 1000 average is shifted to 0 by minusing Sample Mean from each sample mean. 

In the plot, redline denotes the sample variance and the blue line denotes the theoretical variance. Their value are `r Sample_Var` and `r Theoretical_Var`

### Distribution

```{r echo=FALSE}
norm_mns<-(mns-Sample_Mean)/sqrt(Sample_Var)
hist(norm_mns,freq=FALSE,xlab="sd",xlim=c(-3,3),breaks=20,main="Histogram of normalized sample means")
sd<-NULL
p_norm_mns<-NULL
p_norm<-NULL

for (i in -3:3)
{sd<-c(sd,i)
 p_norm_mns<-c(p_norm_mns,(sum(norm_mns<=i)/1000))
 p_norm<-c(p_norm,(pnorm(i)))
}
sf<-data.frame(sd,p_norm_mns,p_norm)
names(sf)<-c("sd","cum probability of Sample Mean distribution","cum probability of normal distribution")
sf

```

These 1000 sample means are normlized and plotted.The probabily is compared to normal distribution.


## Part 2: Basic Inferential Data Analysis Instructions

### basic exploratory data analyses
```{r,loading data}
data(ToothGrowth)
dim(ToothGrowth)
head(ToothGrowth)
table(ToothGrowth$supp,ToothGrowth$dose)
```

We load the ToothGrowth data. This dataframe has 60 rows and 3 columns. The first column is the length of tooth growth. The second column is the type of supplement used and the third column is the dose.

We tabulate the supplement and dose and find that there are two supplement and three different dose used. 

### basic summary of the data
```{r,process data}
suppressMessages(library(dplyr))
library(ggplot2)
plotdata<- ToothGrowth %>% group_by(supp,dose) %>% summarise(mean=mean(len),se=sd(len)/sqrt(length(len)))
plotdata

g<-ggplot(plotdata,aes(factor(dose),mean,group=supp,color=supp))
g+geom_line(lwd=1)+geom_errorbar(aes(ymin=mean-se,ymax=mean+se),width=0.1)+labs(x="Dose",y="Length")+ggtitle("Tooth Growth")
```
By the type of supp and the dose, we separate the data into 6 groups and plot the mean and sem for each group. From the plotdata, we find that the length of tooth growth increases as the dose of supp increases. The OJ supplement has better improvement than VC supplement in tooth growth at lower dose (0.5 and 1). The effect of two supplements are comparable at higher dose (2).

### Hypothesis testing
```{r, hypothesis test}
OJ_0.5<-ToothGrowth[ToothGrowth$supp=="OJ"&ToothGrowth$dose==0.5,]$len
OJ_1<-ToothGrowth[ToothGrowth$supp=="OJ"&ToothGrowth$dose==1,]$len
OJ_2<-ToothGrowth[ToothGrowth$supp=="OJ"&ToothGrowth$dose==2,]$len

VC_0.5<-ToothGrowth[ToothGrowth$supp=="VC"&ToothGrowth$dose==0.5,]$len
VC_1<-ToothGrowth[ToothGrowth$supp=="VC"&ToothGrowth$dose==1,]$len
VC_2<-ToothGrowth[ToothGrowth$supp=="VC"&ToothGrowth$dose==2,]$len

#IN OJ supplement groups,compare the effect of different dose
t.test(OJ_0.5,OJ_1)$p.value
t.test(OJ_1,OJ_2)$p.value

#IN VC supplement groups,compare the effect of different dose
t.test(VC_0.5,VC_1)$p.value
t.test(VC_1,VC_2)$p.value

#Compare OJ supplement and VC supplement at the same dose
t.test(OJ_0.5,VC_0.5)$p.value
t.test(OJ_1,VC_1)$p.value
t.test(OJ_2,VC_2)$p.value
```

### Conclusion
For both supplement, the teeth growth increases significantly as the dose increase. The effect of OJ is significantly better than that of VC at the dose of 0.5 and 1 but the effect are comparable between these two supplement at the dose of 2.

