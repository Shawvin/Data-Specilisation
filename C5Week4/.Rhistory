ggplot(cars,aes(speed,dist,color=speed))+geom_boxplot()
library(dplyr)
setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2")
select_data<-select(data,EVTYPE,FATALITIES,INJURIES,PROPDMG,CROPDMG)
plotdata<-select_data %>% group_by(EVTYPE) %>% summarise(FATALITIES=mean(FATALITIES),INJURIES=mean(INJURIES),PROPDMG=mean(PROPDMG),CROPDMG=mean(CROPDMG))
Most_Fatal<-plotdata[order(FATALITIES)][1:10,2]
Most_Fatal<-plotdata[order(plotdata$FATALITIES)][1:10,2]
head(plotdata)
Most_Fatal<-plotdata[order(plotdata$FATALITIES)]
Most_Fatal<-plotdata[order(plotdata$FATALITIES),]
Most_Fatal<-plotdata[order(plotdata$FATALITIES),][1:10,2]
Most_Fatal
?order
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:10,c(1,2)]
Most_Fatal
knitr::opts_chunk$set(echo = TRUE)
par(mar=c(2,1))
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(EVTYPE,FATALITIES))+geom_bar()
## Data Processing
library(dplyr)
library(ggplot2)
setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2")
select_data<-select(data,EVTYPE,FATALITIES,INJURIES,PROPDMG,CROPDMG)
plotdata<-select_data %>% group_by(EVTYPE) %>% summarise(FATALITIES=mean(FATALITIES),INJURIES=mean(INJURIES),PROPDMG=mean(PROPDMG),CROPDMG=mean(CROPDMG))
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(EVTYPE,FATALITIES))+geom_bar()
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(x=EVTYPE,y=FATALITIES))+geom_bar()
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(y=FATALITIES))+geom_bar()
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(y=FATALITIES))+geom_bar()
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(x=EVTYPE,y=FATALITIES))+geom_bar(stat="identity")
ggplot(Most_Injured,aes(x=EVTYPE,y=INJURIES))+geom_bar()
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(x=EVTYPE,y=FATALITIES))+geom_bar(stat="identity")
ggplot(Most_Injured,aes(x=EVTYPE,y=INJURIES))+geom_bar(stat="identity")
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:10,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:10,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:10,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:10,c(1,5)]
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(x=EVTYPE,y=FATALITIES))+geom_bar(stat="identity")
ggplot(Most_Injured,aes(x=EVTYPE,y=INJURIES))+geom_bar(stat="identity")
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:5,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:5,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:5,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:5,c(1,5)]
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(x=EVTYPE,y=FATALITIES))+geom_bar(stat="identity")
ggplot(Most_Injured,aes(x=EVTYPE,y=INJURIES))+geom_bar(stat="identity")
??ggplot
library(dplyr)
library(ggplot2)
library(dplyr)
library(ggplot2)
setwd("C5Week4")
library(dplyr)
library(ggplot2)
if (!file.exists("repdata_data_StormData.csv.bz2")) setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2")
select_data<-select(data,EVTYPE,FATALITIES,INJURIES,PROPDMG,CROPDMG)
plotdata<-select_data %>% group_by(EVTYPE) %>% summarise(FATALITIES=mean(FATALITIES),INJURIES=mean(INJURIES),PROPDMG=mean(PROPDMG),CROPDMG=mean(CROPDMG))
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:5,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:5,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:5,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:5,c(1,5)]
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(x=EVTYPE,y=FATALITIES))+geom_bar(stat="identity")
ggplot(Most_Injured,aes(x=EVTYPE,y=INJURIES))+geom_bar(stat="identity")
par(mfrow=c(2,1))
ggplot(Most_PROPDMG,aes(x=EVTYPE,y=PROPDMG))+geom_bar(stat="identity")
ggplot(Most_CROPDMG,aes(x=EVTYPE,y=CROPDMG))+geom_bar(stat="identity")
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(x=EVTYPE,y=FATALITIES))+geom_bar(stat="identity")
ggplot(Most_Injured,aes(x=EVTYPE,y=INJURIES))+geom_bar(stat="identity")
###TOP 5 events that caused property damage
`r Most_PROPDMG`
`r Most_Fatal`
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:5,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:5,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:5,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:5,c(1,5)]
## Result
###TOP 5 events that caused fatalites
`r Most_Fatal`
par(mfrow=c(2,1))
ggplot(Most_PROPDMG,aes(x=EVTYPE,y=PROPDMG))+geom_bar(stat="identity")
ggplot(Most_CROPDMG,aes(x=EVTYPE,y=CROPDMG))+geom_bar(stat="identity")
Most_Fatal
Most_Injured
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(EVTYPE,FATALITIES))+geom_bar(stat="identity")
ggplot(Most_Injured,aes(EVTYPE,INJURIES))+geom_bar(stat="identity")
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(EVTYPE,FATALITIES))+geom_bar(stat="identity")
ggplot(Most_Injured,aes(EVTYPE,INJURIES))+geom_bar(stat="identity")
par(mfrow=c(2,1))
ggplot(Most_PROPDMG,aes(EVTYPE,PROPDMG))+geom_bar(stat="identity")
ggplot(Most_CROPDMG,aes(EVTYPE,CROPDMG))+geom_bar(stat="identity")
library(dplyr)
library(ggplot2)
if (!file.exists("repdata_data_StormData.csv.bz2")) setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2")
select_data<-select(data,EVTYPE,FATALITIES,INJURIES,PROPDMG,CROPDMG)
plotdata<-select_data %>% group_by(EVTYPE) %>% summarise(FATALITIES=mean(FATALITIES),INJURIES=mean(INJURIES),PROPDMG=mean(PROPDMG),CROPDMG=mean(CROPDMG))
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:5,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:5,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:5,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:5,c(1,5)]
par(mfrow=c(2,1))
g1<-ggplot(Most_Fatal,aes(EVTYPE,FATALITIES))+geom_bar(stat="identity")
g2<-ggplot(Most_Injured,aes(EVTYPE,INJURIES))+geom_bar(stat="identity")
library(ggplot2)
head(mtcars)
?se
?sd
par(mfrow=c(2,1))
g1<-ggplot(Most_Fatal,aes(EVTYPE,FATALITIES))+geom_bar(stat="identity")
g2<-ggplot(Most_Injured,aes(EVTYPE,INJURIES))+geom_bar(stat="identity")
Most_Fatal
Most_CROPDMG
Most_PROPDMG
library(dplyr)
if (!file.exists("repdata_data_StormData.csv.bz2")) setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2")
select_data<-select(data,EVTYPE,FATALITIES,INJURIES,PROPDMG,CROPDMG)
plotdata<-select_data %>% group_by(EVTYPE) %>% summarise(FATALITIES=mean(FATALITIES),INJURIES=mean(INJURIES),PROPDMG=mean(PROPDMG),CROPDMG=mean(CROPDMG))
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:3,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:3,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:3,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:3,c(1,5)]
library(ggplot2)
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(EVTYPE,FATALITIES))+geom_bar(stat="identity")
ggplot(Most_Injured,aes(EVTYPE,INJURIES))+geom_bar(stat="identity")
library(ggplot2)
par(mfrow=c(2,1))
ggplot(Most_PROPDMG,aes(EVTYPE,PROPDMG))+geom_bar(stat="identity")
ggplot(Most_CROPDMG,aes(EVTYPE,CROPDMG))+geom_bar(stat="identity")
Most_Fatal
str(data)
table(data$PROPDMGEXP)
table(data$CROPDMGEXP)
unique(data$PROPDMGEXP)
length(unique(data$PROPDMGEXP))
levels(data$PROPDMGEXP)
levels(data$CROPDMGEXP)
gsub([mM],10^6,data$PROPDMGEXP)
gsub
?gsub
gsub("[mM]",10^6,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[0-9-+?hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[0-9+][hH+][-+?]",1,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[0-9]+[hH]+[-+?]+",1,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
table(data$PROPDMGEXP)
table(data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[0-9]*[hH]*[-?+]*",1,data$cROPDMGEXP)
data$CROPDMGEXP<-gsub("[0-9]*[hH]*[-?+]*",1,data$CROPDMGEXP)
table(data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[0-9]?[hH]?[-?+]?",1,data$CROPDMGEXP)
table(data$CROPDMGEXP)
data<-read.csv("repdata_data_StormData.csv.bz2")
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[0-9]?[hH]?[-?+]?",1,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data<-read.csv("repdata_data_StormData.csv.bz2")
data1<-data
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[0-9]?[hH]?[-?+]?",1,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data1<-data
data<-read.csv("repdata_data_StormData.csv.bz2")
data1<-data
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]+[hH]+",1,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]*[hH]*",1,data$PROPDMGEXP)
table(data$PROPDMGEXP)
data<-data1
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
table(data$PROPDMGEXP)
levels(data$PROPDMGEXP)
class(data$PROPDMGEXP)
unique(data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$PROPDMGEXP)
table(data$CROPDMGEXP)
table(data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[0-9]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[?]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[kK]",10^3,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[mM]",10^6,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[Bb]",10^9,data$CROPDMGEXP)
data$CROPDMGEXP<-as.numeric(data$CROPDMGEXP)
library(ggplot2)
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(EVTYPE,FATALITIES,fill=EVTYPE))+geom_bar(stat="identity")+coord_flip()
ggplot(Most_Injured,aes(EVTYPE,INJURIES,fill=EVTYPE))+geom_bar(stat="identity")+coord_flip()
library(ggplot2)
par(mfrow=c(2,1))
ggplot(Most_Fatal,aes(EVTYPE,FATALITIES,fill=EVTYPE))+geom_bar(stat="identity")+coord_flip()
ggplot(Most_Injured,aes(EVTYPE,INJURIES,fill=EVTYPE))+geom_bar(stat="identity")+coord_flip()
library(dplyr)
if (!file.exists("repdata_data_StormData.csv.bz2")) setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2")
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[0-9]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[?]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[kK]",10^3,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[mM]",10^6,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[Bb]",10^9,data$CROPDMGEXP)
data$CROPDMGEXP<-as.numeric(data$CROPDMGEXP)
##only select the column realted to public health and economy
select_data<-select(data,EVTYPE,FATALITIES,INJURIES,PROPDMG,PROPDMGEXP,CROPDMG,CROPDMGEXP)
##sum the damage caused by each event
plotdata<-select_data %>% group_by(EVTYPE) %>% summarise(FATALITIES=sum(FATALITIES),INJURIES=sum(INJURIES),PROPDMG=sum(PROPDMG*PROPDMGEXP),CROPDMG=sum(CROPDMG*CROPDMGEXP))
##choose the top 3 events that cause damage to public health and economy
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:5,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:5,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:3,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:3,c(1,5)]
library(dplyr)
if (!file.exists("repdata_data_StormData.csv.bz2")) setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2")
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$PROPDMGEXP)
table(data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[0-9]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[?]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[kK]",10^3,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[mM]",10^6,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[Bb]",10^9,data$CROPDMGEXP)
data$CROPDMGEXP<-as.numeric(data$CROPDMGEXP)
table(data$CROPDMGEXP)
##only select the column realted to public health and economy
select_data<-select(data,EVTYPE,FATALITIES,INJURIES,PROPDMG,PROPDMGEXP,CROPDMG,CROPDMGEXP)
##sum the damage caused by each event
plotdata<-select_data %>% group_by(EVTYPE) %>% summarise(FATALITIES=sum(FATALITIES),INJURIES=sum(INJURIES),PROPDMG=sum(PROPDMG*PROPDMGEXP),CROPDMG=sum(CROPDMG*CROPDMGEXP))
##choose the top 3 events that cause damage to public health and economy
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:5,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:5,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:3,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:3,c(1,5)]
table(data$PROPDMGEXP)
library(dplyr)
if (!file.exists("repdata_data_StormData.csv.bz2")) setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2")
table(data$PROPDMGEXP)
data$PROPDMGEXP(is.na(data$PROPDMGEXP))<-1
table(data$PROPDMGEXP)
data$PROPDMGEXP[is.na(data$PROPDMGEXP)]<-1
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP[is.na(data$PROPDMGEXP)]<-1
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$PROPDMGEXP)
library(dplyr)
if (!file.exists("repdata_data_StormData.csv.bz2")) setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2")
table(data$PROPDMGEXP)
data$PROPDMGEXP[is.na(data$PROPDMGEXP)]<-1
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$PROPDMGEXP)
table(data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[0-9]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[?]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[kK]",10^3,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[mM]",10^6,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[Bb]",10^9,data$CROPDMGEXP)
data$CROPDMGEXP<-as.numeric(data$CROPDMGEXP)
table(data$CROPDMGEXP)
##only select the column realted to public health and economy
select_data<-select(data,EVTYPE,FATALITIES,INJURIES,PROPDMG,PROPDMGEXP,CROPDMG,CROPDMGEXP)
##sum the damage caused by each event
plotdata<-select_data %>% group_by(EVTYPE) %>% summarise(FATALITIES=sum(FATALITIES),INJURIES=sum(INJURIES),PROPDMG=sum(PROPDMG*PROPDMGEXP),CROPDMG=sum(CROPDMG*CROPDMGEXP))
##choose the top 3 events that cause damage to public health and economy
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:5,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:5,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:3,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:3,c(1,5)]
data<-read.csv("repdata_data_StormData.csv.bz2")
table(data$PROPDMGEXP)
data$PROPDMGEXP[is.na(data$PROPDMGEXP)]<-1
table(data$PROPDMGEXP)
table(is.na(data$PROPDMGEXP)
)
table(data$PROPDMGEXP="")
table(data$PROPDMGEXP=="")
table(data$PROPDMGEXP)
data$PROPDMGEXP[data$PROPDMGEXP=""]<-1
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$PROPDMGEXP)
library(dplyr)
if (!file.exists("repdata_data_StormData.csv.bz2")) setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2")
table(data$PROPDMGEXP)
data$PROPDMGEXP[data$PROPDMGEXP==""]<-1
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$PROPDMGEXP)
table(data$CROPDMGEXP)
data$CROPDMGEXP[data$CROPDMGEXP==""]<-1
data$CROPDMGEXP<-gsub("[0-9]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[?]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[kK]",10^3,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[mM]",10^6,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[Bb]",10^9,data$CROPDMGEXP)
data$CROPDMGEXP<-as.numeric(data$CROPDMGEXP)
table(data$CROPDMGEXP)
##only select the column realted to public health and economy
select_data<-select(data,EVTYPE,FATALITIES,INJURIES,PROPDMG,PROPDMGEXP,CROPDMG,CROPDMGEXP)
##sum the damage caused by each event
plotdata<-select_data %>% group_by(EVTYPE) %>% summarise(FATALITIES=sum(FATALITIES),INJURIES=sum(INJURIES),PROPDMG=sum(PROPDMG*PROPDMGEXP),CROPDMG=sum(CROPDMG*CROPDMGEXP))
##choose the top 3 events that cause damage to public health and economy
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:5,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:5,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:3,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:3,c(1,5)]
data<-read.csv("repdata_data_StormData.csv.bz2")
data1<-data
table(data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[0-9]?",1,data$PROPDMGEXP)
table(data$PROPDMGEXP)
levels(data$PROPDMGEXP)
data<-data1
levels(data$PROPDMGEXP)
data$PROPDMGEXP[data$PROPDMGEXP==""]<-1
levels(data$PROPDMGEXP)
table(data$PROPDMGEXP)
data$PROPDMGEXP[data$PROPDMGEXP==""]<-1
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$PROPDMGEXP)
data<data1
data<-data1
table(data$PROPDMGEXP)
data$PROPDMGEXP[data$PROPDMGEXP==""]<-1
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$PROPDMGEXP)
table(data$CROPDMGEXP)
data$CROPDMGEXP[data$CROPDMGEXP==""]<-1
str(data)
data<dat1
data<data1
data<-data1
str(data)
data$PROPDMGEXP[data$PROPDMGEXP==""]<-1
data$CROPDMGEXP[data$CROPDMGEXP==""]<-1
table(data$CROPDMGEXP=="")
data<-data1
table(data$CROPDMGEXP=="")
table(data$CROPDMGEXP)
str(data)
levels(data$CROPDMGEXP)
unique(data$CROPDMGEXP)
unique(data$PROPDMGEXP)
data$CROPDMGEXP[data$CROPDMGEXP==""]<-0
table(data$CROPDMGEXP)
library(dplyr)
if (!file.exists("repdata_data_StormData.csv.bz2")) setwd("C5Week4")
data<-read.csv("repdata_data_StormData.csv.bz2",stringsAsFactors = FALSE)
table(data$PROPDMGEXP)
data$PROPDMGEXP[data$PROPDMGEXP==""]<-1
data$PROPDMGEXP<-gsub("[0-9]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[-?+]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[hH]",1,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[kK]",10^3,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[mM]",10^6,data$PROPDMGEXP)
data$PROPDMGEXP<-gsub("[Bb]",10^9,data$PROPDMGEXP)
data$PROPDMGEXP<-as.numeric(data$PROPDMGEXP)
table(data$PROPDMGEXP)
table(data$CROPDMGEXP)
data$CROPDMGEXP[data$CROPDMGEXP==""]<-1
data$CROPDMGEXP<-gsub("[0-9]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[?]",1,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[kK]",10^3,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[mM]",10^6,data$CROPDMGEXP)
data$CROPDMGEXP<-gsub("[Bb]",10^9,data$CROPDMGEXP)
data$CROPDMGEXP<-as.numeric(data$CROPDMGEXP)
table(data$CROPDMGEXP)
##only select the column realted to public health and economy
select_data<-select(data,EVTYPE,FATALITIES,INJURIES,PROPDMG,PROPDMGEXP,CROPDMG,CROPDMGEXP)
##sum the damage caused by each event
plotdata<-select_data %>% group_by(EVTYPE) %>% summarise(FATALITIES=sum(FATALITIES),INJURIES=sum(INJURIES),PROPDMG=sum(PROPDMG*PROPDMGEXP),CROPDMG=sum(CROPDMG*CROPDMGEXP))
##choose the top 3 events that cause damage to public health and economy
Most_Fatal<-plotdata[order(plotdata$FATALITIES,decreasing=TRUE),][1:5,c(1,2)]
Most_Injured<-plotdata[order(plotdata$INJURIES,decreasing=TRUE),][1:5,c(1,3)]
Most_PROPDMG<-plotdata[order(plotdata$PROPDMG,decreasing=TRUE),][1:3,c(1,4)]
Most_CROPDMG<-plotdata[order(plotdata$CROPDMG,decreasing=TRUE),][1:3,c(1,5)]
library(ggplot2)
par(mfrow=c(2,1))
ggplot(Most_PROPDMG,aes(EVTYPE,PROPDMG,color=EVTYPE))+geom_bar(stat="identity")+coord_flip()
ggplot(Most_CROPDMG,aes(EVTYPE,CROPDMG,color=EVTYPRE))+geom_bar(stat="identity")+coord_flip()
library(ggplot2)
par(mfrow=c(2,1))
ggplot(Most_PROPDMG,aes(EVTYPE,PROPDMG,color=EVTYPE))+geom_bar(stat="identity")+coord_flip()
ggplot(Most_CROPDMG,aes(EVTYPE,CROPDMG,color=EVTYPE))+geom_bar(stat="identity")+coord_flip()
library(ggplot2)
par(mfrow=c(2,1))
ggplot(Most_PROPDMG,aes(EVTYPE,PROPDMG,fill=EVTYPE))+geom_bar(stat="identity")+coord_flip()
ggplot(Most_CROPDMG,aes(EVTYPE,CROPDMG,fill=EVTYPE))+geom_bar(stat="identity")+coord_flip()
?summarySE
??summarySE
library(ggplot2)
?summarySE
library(dplyr)
?summarySE
dim(cars)
library(dplyr)
head(cars)
plotdata<-cars %>% group_by(speed) %>% summarise(dist=mean(dist),sd=sd(dist),se=sd(dist)/sqrt(length(dist())))
plotdata<-cars %>% group_by(speed) %>% summarise(dist=mean(dist),sd=sd(dist),se=sd(dist)/sqrt(length(dist))
)
plotdata
plotdata<-cars %>% group_by(speed) %>% summarise(dist=mean(dist),sd=sd(dist))
plotdata
str(plotdata)
?sd
plotdata<-cars %>% group_by(speed) %>% summarise(dist=mean(dist),n=length(dist))
str(plotdata)
plotdata
plotdata<-cars %>% group_by(speed) %>% summarise(meandist=mean(dist),n=length(dist))
plotdata
plotdata<-cars %>% group_by(speed) %>% summarise(meandist=mean(dist),sd=sd(dist),se=sd/sqrt(length(dist))
)
plotdata
ggplot(plotdata,aes(speed,meandist))+geom_line()+geom_errorbar(aes(ymin=meandist-se,ymax=meandist+se),width=0.1)
ggplot(plotdata,aes(speed,meandist))+geom_line()+geom_errorbar(aes(ymin=meandist-se,ymax=meandist+se),width=0.1,position=pd)
